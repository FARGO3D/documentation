
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Defining a new SETUP &#8212; FARGO3D User Guide</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'new_setup';</script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Outputs" href="outputs.html" />
    <link rel="prev" title="Induction equation" href="induction_equation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
    <meta name="docbuild:last-update" content="Dec 20, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">FARGO3D User Guide</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="download.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to the code</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributors.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">Citing FARGO3D</a></li>

<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="first_steps.html">First Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="dir_tree.html">Directory tree</a></li>
<li class="toctree-l1"><a class="reference internal" href="make_proc.html">Make Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundaries.html">Boundaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh_fields.html">Mesh and Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="def_setups.html">Default SETUPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="opt_file.html">.opt files</a></li>
<li class="toctree-l1"><a class="reference internal" href="non_uniform_meshes.html">Non-uniform meshes</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbody.html">N-Body solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="units.html">Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="multifluid.html">Multifluid</a></li>
<li class="toctree-l1"><a class="reference internal" href="induction_equation.html">Induction equation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Defining a new SETUP</a></li>

<li class="toctree-l1"><a class="reference internal" href="outputs.html">Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="communications.html">Communications</a></li>
<li class="toctree-l1"><a class="reference internal" href="c2cuda.html">Cuda translator (C2CUDA.py)</a></li>
<li class="toctree-l1"><a class="reference internal" href="exec_flags.html">Execution flags</a></li>
<li class="toctree-l1"><a class="reference internal" href="vtk_comp.html">VTK Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="cuda_perf.html">Improving CUDA Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmark.html">GPU vs CPU Benchmarking</a></li>
<li class="toctree-l1"><a class="reference internal" href="complex_setup.html">Developing a complex setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="ttt.html">Tips, Tricks, Todos and Troubleshooting</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/new_setup.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Defining a new SETUP</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Defining a new SETUP</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#blob-test">Blob test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#making-the-setup-directory">Making the setup directory:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-boundaries">Defining boundaries:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-the-parameter-file">Defining the parameter file</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opt-file">.opt file.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-state">Initial state:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#making-the-executable">Making the executable:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-your-new-setup">Plotting your new setup:</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#run-time-visualization">Run-time visualization.</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-it-work">How does it work?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#backends">Backends</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="defining-a-new-setup">
<h1>Defining a new SETUP<a class="headerlink" href="#defining-a-new-setup" title="Link to this heading">#</a></h1>
<p>This section is a small tutorial about how to define a setup from
scratch. In this tutorial we will implement a hydrodynamics
setup. The name of setup will be “blob”.</p>
<section id="blob-test">
<h2>Blob test<a class="headerlink" href="#blob-test" title="Link to this heading">#</a></h2>
<p>This is a 2D test where there is a background uniform fluid and a denser
fluid disk or blob embedded. The system is force-balanced (i.e. in pressure
equilibrium) when there is no velocity between the two fluids. We will simulate
the blob moving at a supersonic speed.</p>
<p>Parameters of the test:</p>
<ul class="simple">
<li><p>Mach number: 2.7</p></li>
<li><p>Density jump: 10</p></li>
<li><p>Pressure equilibria</p></li>
<li><p>gamma: 5/3</p></li>
</ul>
<p>We will do the test in the XY plane, and we will implement periodic
boundaries in X and reflexive boundaries in Y. We will do a second
test with free outflow boundaries in Y.</p>
<p>In order to implement this setup we need:</p>
<ol class="arabic simple">
<li><p>A setup name: In this case will be “myblob”.</p></li>
<li><p>Therefore a directory inside <code class="docutils literal notranslate"><span class="pre">setups/</span></code> called <code class="docutils literal notranslate"><span class="pre">myblob</span></code>.</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">.bound</span></code> file in that directory, called <code class="docutils literal notranslate"><span class="pre">myblob.bound.0</span></code>.</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">.par</span></code> file in that directory, called <code class="docutils literal notranslate"><span class="pre">myblob.par</span></code>.</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">.opt</span></code> file in that directory, called <code class="docutils literal notranslate"><span class="pre">myblob.opt</span></code>.</p></li>
<li><p>the file called <code class="docutils literal notranslate"><span class="pre">condinit.c</span></code> in that directory. This is   where the fields are initialized.</p></li>
</ol>
<p>Optionally:</p>
<ul class="simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">.units</span></code> file, called <code class="docutils literal notranslate"><span class="pre">myblob.units</span></code>.</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">.mandatory</span></code> file, called <code class="docutils literal notranslate"><span class="pre">myblob.mandatory</span></code>.</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">.objects</span></code> file, called <code class="docutils literal notranslate"><span class="pre">myblob.objects</span></code>.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">boundaries.txt</span></code> file (if it is not present it will be taken
from the <code class="docutils literal notranslate"><span class="pre">std/</span></code> directory).</p></li>
</ul>
<section id="making-the-setup-directory">
<h3>Making the setup directory:<a class="headerlink" href="#making-the-setup-directory" title="Link to this heading">#</a></h3>
<p>We start by creating the setup directory <code class="docutils literal notranslate"><span class="pre">myblob</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$: cd setups/
$: mkdir myblob
</pre></div>
</div>
</section>
<section id="defining-boundaries">
<h3>Defining boundaries:<a class="headerlink" href="#defining-boundaries" title="Link to this heading">#</a></h3>
<p>We define from scratch all the boundaries in the setup. In order to do
that we create a file called <code class="docutils literal notranslate"><span class="pre">boundaries.txt</span></code> inside <code class="docutils literal notranslate"><span class="pre">setups/myblob/</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$: emacs boundaries.txt
</pre></div>
</div>
<p>Naturally, you may use your favorite editor instead of emacs…</p>
<p>Now, we write these lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SYMMETRIC</span><span class="p">:</span>
           <span class="n">Centered</span><span class="p">:</span>    <span class="o">|</span><span class="n">a</span><span class="o">|</span><span class="n">a</span><span class="o">|</span>
           <span class="n">Staggered</span><span class="p">:</span>   <span class="o">|</span><span class="n">a</span><span class="o">|</span><span class="n">a</span><span class="o">|</span><span class="n">a</span><span class="o">|</span>

<span class="n">ANTISYMMETRIC</span><span class="p">:</span>
           <span class="n">Staggered</span><span class="p">:</span>   <span class="o">|-</span><span class="n">a</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="n">a</span><span class="o">|</span>
</pre></div>
</div>
<p>We will use the SYMMETRIC boundary for both reflective and free
outflow boundaries,
and ANTISYMMETRIC only for the normal velocity Vy in the reflective case.</p>
<p>We must create the file myblob.bound:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$: emacs myblob.bound.0
</pre></div>
</div>
<p>And write this lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Density</span><span class="p">:</span>
        <span class="n">Ymin</span><span class="p">:</span> <span class="n">SYMMETRIC</span>
        <span class="n">Ymax</span><span class="p">:</span> <span class="n">SYMMETRIC</span>

<span class="n">Energy</span><span class="p">:</span>
        <span class="n">Ymin</span><span class="p">:</span> <span class="n">SYMMETRIC</span>
        <span class="n">Ymax</span><span class="p">:</span> <span class="n">SYMMETRIC</span>

<span class="n">Vx</span><span class="p">:</span>
        <span class="n">Ymin</span><span class="p">:</span>   <span class="n">SYMMETRIC</span>
        <span class="n">Ymax</span><span class="p">:</span>   <span class="n">SYMMETRIC</span>

<span class="n">Vy</span><span class="p">:</span>
        <span class="n">Ymin</span><span class="p">:</span>   <span class="n">ANTISYMMETRIC</span>
        <span class="n">Ymax</span><span class="p">:</span>   <span class="n">ANTISYMMETRIC</span>
</pre></div>
</div>
<p>We say that all our fields are symmetric, but vy should be reflected
in Y. This set is the reflective boundary condition on Y. The free
outflow is the same, except for:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Vy</span><span class="p">:</span>
        <span class="n">Ymin</span><span class="p">:</span>   <span class="n">SYMMETRIC</span>
        <span class="n">Ymax</span><span class="p">:</span>   <span class="n">SYMMETRIC</span>
</pre></div>
</div>
</section>
<section id="defining-the-parameter-file">
<span id="parfile"></span><h3>Defining the parameter file<a class="headerlink" href="#defining-the-parameter-file" title="Link to this heading">#</a></h3>
<p>The parameter file is very useful when we want to change a value
inside the code but you do not want to recompile the code. It is used
in much the same way as with the former FARGO code. Yet in that code,
parameters were defined in a rather manual way, in a file called
<code class="docutils literal notranslate"><span class="pre">var.c</span></code>. With FARGO3D we do not have to edit this file. Rather, we
provide in the SETUP sub directory a template parameter file that has
same name as the setup plus the .par extension. From this file, a
Python script will automagically draw a list of all global variables
and guess their type, and will make a <code class="docutils literal notranslate"><span class="pre">var.c</span></code> accordingly, in a
manner transparent to the user. At run time the user is free to run the
code either with this .par file, or any other .par file in another
directory, without rebuilt.</p>
<p>There are a set of minimal requirement in a .par file, related with
the mesh size, and output parameters. We will start with the basic
parameters:</p>
<p>We edit the new file <code class="docutils literal notranslate"><span class="pre">myblob.par</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$: touch myblob.par
</pre></div>
</div>
<p>and write inside something similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Setup</span>                   <span class="n">myblob</span>

<span class="n">Nx</span>                      <span class="mi">400</span>
<span class="n">Ny</span>                      <span class="mi">100</span>
<span class="n">Xmin</span>                   <span class="o">-</span><span class="mf">2.0</span>
<span class="n">Xmax</span>                    <span class="mf">2.0</span>
<span class="n">Ymin</span>                   <span class="o">-</span><span class="mf">0.5</span>
<span class="n">Ymax</span>                    <span class="mf">0.5</span>

<span class="n">Ntot</span>                    <span class="mi">1000</span>
<span class="n">Ninterm</span>                 <span class="mi">1</span>
<span class="n">DT</span>                      <span class="mf">0.05</span>
<span class="n">OutputDir</span>               <span class="n">outputs</span><span class="o">/</span><span class="n">myblob</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because a Python script will automagically create a <code class="docutils literal notranslate"><span class="pre">var.c</span></code> file
(similar to that of the former FARGO code) out of this newly
created parameter file, we must help the script to guess correctly
the type of each variable. For instance, if we write “Xmin   -2”
instead of “Xmin   -2.0”, it will wrongly deduce that <em>Xmin</em> is an
integer, not a floating point value, with highly unpleasant
consequences at run time. Similarly, the figure “-0.5” is correctly
recognized by the script, but “-.5” would not be.</p>
</div>
<p>Now, we will define the parameters specific to our setup. They are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gamma</span>                   <span class="mf">1.666667</span>
<span class="n">rho21</span>                   <span class="mf">10.0</span>
<span class="n">mach</span>                    <span class="mf">2.7</span>
<span class="n">rblob</span>                   <span class="mf">0.15</span>
<span class="n">xblob</span>                  <span class="o">-</span><span class="mf">1.0</span>
<span class="n">yblob</span>                   <span class="mf">0.0</span>
</pre></div>
</div>
<p>where gamma is the adiabatic index, rho21 is the quotient between the
density in the circle (2) and outside (1), and the same for the
temperature; rblob is the radius of the initial blob, normalized by
the vertical size of the box; [xy]blob is the initial position of the
blob.</p>
<p>The observant reader will notice that <em>gamma</em> is already defined in
<code class="docutils literal notranslate"><span class="pre">std/stdpar.par</span></code>, with the same value. Since both sets of parameters
are used (those of <code class="docutils literal notranslate"><span class="pre">std/stdpar.par</span></code> and those of
<code class="docutils literal notranslate"><span class="pre">setups/myblob/myblob.par</span></code>), the first line in the block above is
actually redundant and could have been omitted.</p>
</section>
<section id="opt-file">
<h3>.opt file.<a class="headerlink" href="#opt-file" title="Link to this heading">#</a></h3>
<p>Our setup is 2D, and we want to use the energy equation. In the code’s
jargon, we refer to this as an <em>adiabatic</em> situation. We work in Cartesian coordinates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$: emacs myblob.opt
</pre></div>
</div>
<p>The minimal <code class="docutils literal notranslate"><span class="pre">.opt</span></code> file should be similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>FLUIDS := 0
NFLUIDS = 1
FARGO_OPT += -DNFLUIDS=${NFLUIDS}

FARGO_OPT += -DX
FARGO_OPT += -DY
FARGO_OPT += -DADIABATIC
FARGO_OPT += -DCARTESIAN
ifeq (${GPU}, 1)
FARGO_OPT += -DBLOCK_X=16
FARGO_OPT += -DBLOCK_Y=16
FARGO_OPT += -DBLOCK_Z=1
endif
</pre></div>
</div>
<p>If you want to use simple precision, you can set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FARGO_OPT</span> <span class="o">+=</span> <span class="o">-</span><span class="n">DFLOAT</span>
</pre></div>
</div>
</section>
</section>
<section id="initial-state">
<h2>Initial state:<a class="headerlink" href="#initial-state" title="Link to this heading">#</a></h2>
<p>Now we must fill all the primitive fields with the initial conditions. The standard method is as follow, step by step:</p>
<ol class="arabic simple">
<li><p>Make a file called condinit.c inside your setup directory. (setups/myblob/condinit.c).</p></li>
<li><p>At the top of this file include the <code class="docutils literal notranslate"><span class="pre">fargo3d.h</span></code> header.</p></li>
<li><p>Define a function called CondInit() that returns a <code class="docutils literal notranslate"><span class="pre">void</span></code>.</p></li>
<li><p>Fill the Field_variable-&gt;field_cpu with the data, for each field of
the problem.</p></li>
</ol>
<p><strong>step by step</strong></p>
<ol class="arabic">
<li><p>Start by opening the new file for initial conditions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$: emacs condinit.c
</pre></div>
</div>
</li>
<li><p>In the top line include FARGO3D’s header file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;fargo3d.h&quot;</span>
</pre></div>
</div>
</li>
<li><p>Subsequently add lines similar to these:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">Init</span><span class="p">()</span> <span class="p">{</span>


<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Write inside the function something similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">;</span>

<span class="n">real</span><span class="o">*</span> <span class="n">rho</span> <span class="o">=</span> <span class="n">Density</span><span class="o">-&gt;</span><span class="n">field_cpu</span><span class="p">;</span>
<span class="n">real</span><span class="o">*</span> <span class="n">vx</span>  <span class="o">=</span> <span class="n">Vx</span><span class="o">-&gt;</span><span class="n">field_cpu</span><span class="p">;</span>
<span class="n">real</span><span class="o">*</span> <span class="n">vy</span>  <span class="o">=</span> <span class="n">Vy</span><span class="o">-&gt;</span><span class="n">field_cpu</span><span class="p">;</span>
<span class="n">real</span><span class="o">*</span> <span class="n">e</span>   <span class="o">=</span> <span class="n">Energy</span><span class="o">-&gt;</span><span class="n">field_cpu</span><span class="p">;</span>

<span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">=</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="k">for</span> <span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">Nz</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NGHZ</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">Ny</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NGHY</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">Nx</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>

    <span class="n">The</span> <span class="n">fields</span> <span class="n">are</span> <span class="n">filled</span> <span class="n">here</span> <span class="k">with</span> <span class="n">the</span> <span class="n">help</span> <span class="n">of</span> <span class="n">the</span> <span class="s2">&quot;l&quot;</span> <span class="n">index</span><span class="o">.</span>

    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is the basic structure of a routine that works on
fields. Note the pointers and the triple-nested loop. For filling
the fields, we will use the helper index “l”. In this case, the
outer loop is not necessary, but when Z is not defined, by default
NGHZ = 0 and Nz = 1, so there is only one external loop
cycle. Also, in this particular case, we need to define a circle,
and the size of the circle should be resolution-independent, so we
will need to normalize it. We could add the following macrocommand
lines above the initialization of the indices i,j,k</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#define Q1 (xmed(i) - XBLOB)</span>
<span class="c1">#define Q2 (ymed(j) - YBLOB)</span>
</pre></div>
</div>
<p>(Remember, all the upper variables are taken from the .par file.)</p>
<p>Now, inside the innermost loop, we will fill the field. First, we
need a condition about where the blob is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Q1</span><span class="o">*</span><span class="n">Q1</span><span class="o">+</span><span class="n">Q2</span><span class="o">*</span><span class="n">Q2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">RBLOB</span><span class="o">/</span><span class="p">(</span><span class="n">YMAX</span><span class="o">-</span><span class="n">YMIN</span><span class="p">))</span> <span class="p">{</span>

<span class="p">}</span>
</pre></div>
</div>
<p>And inside these curly brackets, for example, the density must to
be RHO21 times denser than the density outside. The inner loop
should be similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rho</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>               <span class="o">//</span> <span class="n">Constant</span> <span class="n">value</span> <span class="n">outside</span>
<span class="n">e</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>   <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">GAMMA</span><span class="o">-</span><span class="mf">1.0</span><span class="p">);</span>   <span class="o">//</span> <span class="n">The</span> <span class="n">isothermal</span> <span class="n">soundspeed</span> <span class="ow">is</span> <span class="n">equal</span> <span class="n">to</span> <span class="mf">1.0</span><span class="o">.</span>
<span class="n">vx</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">GAMMA</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span><span class="o">*</span><span class="n">MACH</span><span class="p">;</span>
<span class="n">vy</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>  <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Q1</span><span class="o">*</span><span class="n">Q1</span><span class="o">+</span><span class="n">Q2</span><span class="o">*</span><span class="n">Q2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">RBLOB</span><span class="o">/</span><span class="p">(</span><span class="n">YMAX</span><span class="o">-</span><span class="n">YMIN</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">rho</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">*=</span> <span class="n">RHO21</span><span class="p">;</span>
      <span class="n">vx</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Finally, it is mandatory to call the function Init() from one labeled CondInit(). This function also needs to create the fluid number 0 (the only fluid present in this setup):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">CondInit</span><span class="p">()</span> <span class="p">{</span>
   <span class="n">Fluids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">CreateFluid</span><span class="p">(</span><span class="s2">&quot;gas&quot;</span><span class="p">,</span><span class="n">GAS</span><span class="p">);</span>
   <span class="n">SelectFluid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
   <span class="n">Init</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ol>
<p>A complete view of the file <code class="docutils literal notranslate"><span class="pre">condinit.c</span></code> is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;fargo3d.h&quot;</span>

<span class="n">void</span> <span class="n">Init</span><span class="p">()</span> <span class="p">{</span>

  <span class="nb">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">;</span>

  <span class="n">real</span><span class="o">*</span> <span class="n">rho</span> <span class="o">=</span> <span class="n">Density</span><span class="o">-&gt;</span><span class="n">field_cpu</span><span class="p">;</span>
  <span class="n">real</span><span class="o">*</span> <span class="n">vx</span>  <span class="o">=</span> <span class="n">Vx</span><span class="o">-&gt;</span><span class="n">field_cpu</span><span class="p">;</span>
  <span class="n">real</span><span class="o">*</span> <span class="n">vy</span>  <span class="o">=</span> <span class="n">Vy</span><span class="o">-&gt;</span><span class="n">field_cpu</span><span class="p">;</span>
  <span class="n">real</span><span class="o">*</span> <span class="n">e</span>   <span class="o">=</span> <span class="n">Energy</span><span class="o">-&gt;</span><span class="n">field_cpu</span><span class="p">;</span>

  <span class="c1">#define Q1 (xmed(i) - XBLOB)</span>
  <span class="c1">#define Q2 (ymed(j) - YBLOB)</span>

  <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">=</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">Nz</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NGHZ</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">Ny</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NGHY</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">Nx</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">rho</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>               <span class="o">//</span> <span class="n">Constant</span> <span class="n">value</span> <span class="n">outside</span>
        <span class="n">e</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>   <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">GAMMA</span><span class="o">-</span><span class="mf">1.0</span><span class="p">);</span>   <span class="o">//</span> <span class="n">The</span> <span class="n">isothermal</span> <span class="n">soundspeed</span> <span class="ow">is</span> <span class="n">equal</span> <span class="n">to</span> <span class="mf">1.0</span><span class="o">.</span>
        <span class="n">vx</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>  <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">GAMMA</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span><span class="o">*</span><span class="n">MACH</span><span class="p">;</span>
        <span class="n">vy</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>  <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>

        <span class="k">if</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Q1</span><span class="o">*</span><span class="n">Q1</span><span class="o">+</span><span class="n">Q2</span><span class="o">*</span><span class="n">Q2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">RBLOB</span><span class="o">/</span><span class="p">(</span><span class="n">YMAX</span><span class="o">-</span><span class="n">YMIN</span><span class="p">))</span> <span class="p">{</span>
          <span class="n">rho</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">*=</span> <span class="n">RHO21</span><span class="p">;</span>
          <span class="n">vx</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">void</span> <span class="n">CondInit</span><span class="p">()</span> <span class="p">{</span>
   <span class="n">Fluids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">CreateFluid</span><span class="p">(</span><span class="s2">&quot;gas&quot;</span><span class="p">,</span><span class="n">GAS</span><span class="p">);</span>
   <span class="n">SelectFluid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
   <span class="n">Init</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="making-the-executable">
<h2>Making the executable:<a class="headerlink" href="#making-the-executable" title="Link to this heading">#</a></h2>
<p>We are now ready to build the code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$: make SETUP=myblob view
</pre></div>
</div>
<p>You may skip the final rule “view” if the build process fails (you
need to install Python’s matplotlib for it to work).</p>
<p>If everything goes fine, you should see a message similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      <span class="n">All</span> <span class="n">objects</span> <span class="n">are</span> <span class="n">OK</span><span class="o">.</span> <span class="n">Linking</span> <span class="n">stage</span>

                <span class="n">FARGO3D</span> <span class="n">SUMMARY</span><span class="p">:</span>
                <span class="o">===============</span>

      <span class="n">This</span> <span class="n">built</span> <span class="ow">is</span> <span class="n">SEQUENTIAL</span><span class="o">.</span> <span class="n">Use</span> <span class="s2">&quot;make para&quot;</span> <span class="n">to</span> <span class="n">change</span> <span class="n">that</span>

      <span class="n">This</span> <span class="n">built</span> <span class="n">has</span> <span class="n">a</span> <span class="n">graphical</span> <span class="n">output</span><span class="p">,</span>
      <span class="n">which</span> <span class="n">uses</span> <span class="n">the</span> <span class="n">python</span><span class="s1">&#39;s matplotlib library.</span>
      <span class="n">Use</span> <span class="s2">&quot;make noview&quot;</span> <span class="n">to</span> <span class="n">change</span> <span class="n">that</span><span class="o">.</span>


      <span class="n">SETUP</span><span class="p">:</span>      <span class="s1">&#39;myblob&#39;</span>
      <span class="p">(</span><span class="n">Use</span> <span class="s2">&quot;make SETUP=[valid_setup_string]&quot;</span> <span class="n">to</span> <span class="n">change</span> <span class="nb">set</span> <span class="n">up</span><span class="p">)</span>
      <span class="p">(</span><span class="n">Use</span> <span class="s2">&quot;make list&quot;</span> <span class="n">to</span> <span class="n">see</span> <span class="n">the</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">setups</span> <span class="n">implemented</span><span class="p">)</span>
      <span class="p">(</span><span class="n">Use</span> <span class="s2">&quot;make info&quot;</span> <span class="n">to</span> <span class="n">see</span> <span class="n">the</span> <span class="n">current</span> <span class="n">sticky</span> <span class="n">build</span> <span class="n">options</span><span class="p">)</span>

<span class="n">And</span> <span class="k">finally</span><span class="p">,</span> <span class="n">we</span> <span class="n">can</span> <span class="n">execute</span> <span class="n">the</span> <span class="n">test</span><span class="p">:</span>
</pre></div>
</div>
<ul class="simple">
<li><p>$: ./fargo3d setups/myblob/myblob.par</p></li>
</ul>
<p>If you want to change the boundaries, you must modify <code class="docutils literal notranslate"><span class="pre">myblob.bound.0</span></code>
and recompile the code (<code class="docutils literal notranslate"><span class="pre">make</span></code> again).</p>
</section>
<section id="plotting-your-new-setup">
<h2>Plotting your new setup:<a class="headerlink" href="#plotting-your-new-setup" title="Link to this heading">#</a></h2>
<p>If you have ipython+pylab working, plotting your new setup is very
easy (see the first run section).</p>
<ul class="simple">
<li><p>$: ipython –pylab</p></li>
<li><p>In [1]: rho = fromfile(“outputs/myblob/gasdens10.dat”,dtype=’float32’).reshape(100,400)</p></li>
<li><p>In [2]: imshow(rho)</p></li>
</ul>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="_images/myblob.png"><img alt="_images/myblob.png" src="_images/myblob.png" style="width: 349.5px; height: 116.0px;" />
</a>
<figcaption>
<p><span class="caption-text">myblob setup at output number 10 (ie at date = OUTPUTNB * NINTERM * DT
= 0.5 here)</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="run-time-visualization">
<h1>Run-time visualization.<a class="headerlink" href="#run-time-visualization" title="Link to this heading">#</a></h1>
<p>FARGO3D has a visualization module, that can be activated for a
specific setup by doing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$:make SETUP=setup view
</pre></div>
</div>
<p>or the equivalent form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$:make SETUP=setup FARGO_DISPLAY=MATPLOTLIB
</pre></div>
</div>
<p>In order to use it you need to have a python-development package (if you are using some package-manager) or simply a basic python installation (the file python.h is needed at compilation time). Also, it is mandatory to have installed matplotlib and numpy packages.</p>
<section id="how-does-it-work">
<h2>How does it work?<a class="headerlink" href="#how-does-it-work" title="Link to this heading">#</a></h2>
<p>Run-time visualization uses an embedded Python interpreter running at
the same time as your simulation. All the related routines are in
<code class="docutils literal notranslate"><span class="pre">src/matplotlib.c</span></code>. The scheme developed to visualize data allows you
to make a visualization routine adapted to your needs. If you work
with matplotlib, you will see that making an interactive plot from within FARGO3D
is the same as working in an interactive session of python+matplotlib. By
default there are three main routines, called <code class="docutils literal notranslate"><span class="pre">plot1d()</span></code>, <code class="docutils literal notranslate"><span class="pre">plot2d()</span></code> and
<code class="docutils literal notranslate"><span class="pre">plot3d()</span></code>. The functionality of each one is obvious from the name. The
most important line for the run-time visualization is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Py_InitializeEx</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<p>Upon execution of this function, you are able to execute any python command inside FARGO3D. A helper function was developed for passing values from FARGO3D to the python interpreter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">pyrun</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="p">,</span> <span class="o">...</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pyrun()</span></code> function works identically to <code class="docutils literal notranslate"><span class="pre">printf()</span></code> (man 3
printf), but <code class="docutils literal notranslate"><span class="pre">pyrun()</span></code> returns a <code class="docutils literal notranslate"><span class="pre">void</span></code>. The main difference
between <code class="docutils literal notranslate"><span class="pre">printf()</span></code> and <code class="docutils literal notranslate"><span class="pre">pyrun()</span></code> is that <code class="docutils literal notranslate"><span class="pre">pyrun()</span></code> prints on the python
interpreter, and the text printed is interpreted as a python
command. In the background, <code class="docutils literal notranslate"><span class="pre">pyrun</span></code> is only a wrapper to the function
<code class="docutils literal notranslate"><span class="pre">PyRun_SimpleString()</span></code>.</p>
<p>In the basic public implementation of the run-time visualization, a set
of helper parameters have been implemented. These parameters should be
included in your <code class="docutils literal notranslate"><span class="pre">.par</span></code> files. You can see the standard value of each
one in <code class="docutils literal notranslate"><span class="pre">std/stdpar.par</span></code>:</p>
<ul>
<li><p>Field: Name of the field you want to plot. Eg: gasdens</p></li>
<li><p>Cmap: A matplotlib palette. Eg: cubehelix  (related to cmap matplotlib karg)</p></li>
<li><p>Log: If you want to use a logarithmic scale for your color map. Values: Yes/No</p></li>
<li><p>Colorbar: If you want to see the colorbar. Values Yes/No</p></li>
<li><p>Autocolor: If you want a dynamic colorbar between the min and max of the field. Values: Yes/No</p></li>
<li><p>Aspect:       The same as the aspect karg of matplotlib (imshow() method). Values: Auto, None</p></li>
<li><p>vmin: Min value for the colorbar. Only if Autocolor is No</p></li>
<li><p>vmax: Max value for the colorbar. Only if Autocolor is No</p></li>
<li><p>PlotLine: Allows to make an arbitrary plot when your simulation is 3D. The field is stored in a 3D numpy array called field. For example, if you want to plot the 2D Z-sum projection, you should do something similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PlotLine</span>         <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">field</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p>Also, you can make a z-slice doing something similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PlotLine</span>         <span class="n">field</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:]</span>
</pre></div>
</div>
<p>where k is an integer with 0&lt;k&lt;NZ.</p>
</section>
<section id="backends">
<h2>Backends<a class="headerlink" href="#backends" title="Link to this heading">#</a></h2>
<p>Matplotlib uses the concept of backend to refer to some specific set
of widgets used for rendering the plot (eg: qt, tkinter, wx, etc). Not
all the backends are compatible with interactive non-blocking
plots. If the main widget that appears after the execution of FARGO3D
does not work, you can try with another backend (see matplotlib
official documentation for more details).  You could consider adding
the file <code class="docutils literal notranslate"><span class="pre">matplotibrc</span></code> to the main FARGO3D directory to configure
matplotlib before running a simulation. This file is
matplotlib-standard (see more details <a class="reference external" href="https://matplotlib.org/stable/users/explain/customizing.html">here</a>), and is version-dependent. If you want to modify
the aspect of the widget, or change the backend, it is a good idea to
start modifying this file.  On linux systems, we tipically use the
backend TKAgg.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="induction_equation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Induction equation</p>
      </div>
    </a>
    <a class="right-next"
       href="outputs.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Outputs</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Defining a new SETUP</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#blob-test">Blob test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#making-the-setup-directory">Making the setup directory:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-boundaries">Defining boundaries:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-the-parameter-file">Defining the parameter file</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opt-file">.opt file.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-state">Initial state:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#making-the-executable">Making the executable:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-your-new-setup">Plotting your new setup:</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#run-time-visualization">Run-time visualization.</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-it-work">How does it work?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#backends">Backends</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Author name not set
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2014-2023, Pablo Benítez Llambay, Frédéric Masset &amp; Contributors.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Dec 20, 2024.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>